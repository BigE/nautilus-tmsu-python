[tox]
# Define the environments you want to test against
envlist = py310, py311, py312, py313, lint, typecheck
# Do not attempt to create a source distribution (setup.py/pyproject.toml is often missing for simple plugins)
skipsdist = True

[testenv]
# Dependencies needed for testing (e.g., pytest, mocks)
deps =
    pytest
    flake8
    # You need stubs for GObject if you want real type checking
    pygobject-stubs
# Commands to run in each environment
commands =
    # 1. Check for syntax errors only (compiles to bytecode)
    python -m compileall src
    # 2. Run unit tests (requires mocking Nautilus, see below)
    pytest

[testenv:lint]
# specific environment for linting
deps = flake8
commands =
	# lint only the src directory
	flake8 src --count --select=E9,F63,F7,F82 --show-source --statistics

[testenv:typecheck]
deps =
    mypy
commands =
    # ignore-missing-imports is crucial because 'Nautilus' module doesn't exist in the venv
    mypy --ignore-missing-imports src